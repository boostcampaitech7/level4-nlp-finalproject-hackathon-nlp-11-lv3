# Level 4. ì¦ê¶Œì‚¬ ìë£Œ ê¸°ë°˜ ì£¼ì‹ LLM ì„œë¹„ìŠ¤

---

# **í”„ë¡œì íŠ¸ ê°œìš”**

### **í”„ë¡œì íŠ¸ ì£¼ì œ**

1. ì£¼ì œ
   - ì¦ê¶Œì‚¬ ìë£Œ ê¸°ë°˜ ì£¼ì‹ LLM ì„œë¹„ìŠ¤ ê°œë°œ
2. ìš”êµ¬ì‚¬í•­
   - PDF ë¬¸ì„œë¡œë¶€í„° í…ìŠ¤íŠ¸, ê·¸ë˜í”„ ë“± ì •ë³´ì˜ ì¶”ì¶œ
   - ë°ì´í„° ë ˆí¬ì§€í† ë¦¬ êµ¬ì¶•(GraphDB, VectorDB ë“±)
   - ì¿¼ë¦¬ì— ëŒ€í•´ ê°€ì¥ ì í•©í•œ ë°ì´í„°ë¥¼ ì°¾ì•„ë‚´ëŠ” RAG ì‹œìŠ¤í…œ êµ¬í˜„
   - í”„ë¡¬í”„íŠ¸ ê°œë°œ
   - ë‹µë³€ ìƒì„±
   - Q&A ê¸°ëŠ¥: ì •ëŸ‰í‰ê°€ ëª©ì 
     - REST API ë¡œ êµ¬í˜„
     - Input: query(ì§ˆì˜)
     - Output: context(ì°¸ì¡°í…ìŠ¤íŠ¸), answer(ë‹µë³€)

### **ë°ì´í„°ì…‹**

1. ì œê³µëœ ë°ì´í„°
   - ì¦ê¶Œì‚¬ ìë£Œ íŒŒì¼(PDF) 100ê°œ

### **í‰ê°€ ë°©ë²•**

1. ì •ëŸ‰í‰ê°€ 50%
   - í…ŒìŠ¤íŠ¸ì…‹ ì§ˆì˜ì— ëŒ€í•œ ë‹µë³€ ì„±ëŠ¥ â€“ ì§€í‘œ G-Eval
2. ì •ì„±í‰ê°€ 50%
   - ì„œë¹„ìŠ¤ì˜ ì°½ì˜ì„±, ìœ ìš©ì„±, ê°œë°œ ì™„ì„±ë„, ì†ŒìŠ¤ì½”ë“œ í’ˆì§ˆ, ë¬¸ì„œí™” ìˆ˜ì¤€

<br>

# **ğŸ‘¨ğŸ»â€ğŸ’»Â íŒ€ì› ì†Œê°œ ë° ì—­í• **

<div align='center'>

|                                                          ì´ë¦„                                                          |                       í”„ë¡œí•„                       |                             ì—­í•                               |
| :--------------------------------------------------------------------------------------------------------------------: | :------------------------------------------------: | :-----------------------------------------------------------: |
| ê¶Œê¸°íƒœ [<img src="images/github-mark.png" width="20" style="vertical-align:middle;">](https://github.com/starlike6617) | <img src='images/profile-1.jpeg' width="80"></img> |     API ì„¤ê³„ ë° ê°œë°œ, RESTful API êµ¬í˜„, OCR ë°ì´í„° í›„ì²˜ë¦¬     |
|  ê¶Œìœ ì§„ [<img src="images/github-mark.png" width="20" style="vertical-align:middle;">](https://github.com/0618yujin)   | <img src='images/profile-2.jpeg' width="80"></img> | í‰ê°€ ë°ì´í„° ì œì‘, OCR ë°ì´í„° í›„ì²˜ë¦¬, Web Design ë° ë°œí‘œ ìë£Œ  |
|    ë°•ë¬´ì¬ [<img src="images/github-mark.png" width="20" style="vertical-align:middle;">](https://github.com/Mujae)     | <img src='images/profile-3.jpeg' width="80"></img> | RAG íŒŒì´í”„ë¼ì¸ êµ¬í˜„, í‰ê°€ ì½”ë“œ êµ¬í˜„ ë° ì‹¤í—˜, í‰ê°€ ë°ì´í„° ì„ ë³„ |
|  ë°•ì •ë¯¸ [<img src="images/github-mark.png" width="20" style="vertical-align:middle;">](https://github.com/imJeongmi)   | <img src='images/profile-4.jpeg' width="80"></img> |        í‰ê°€ ë°ì´í„° ì œì‘, OCR ë°ì´í„° í›„ì²˜ë¦¬, Front-end         |
|   ì´ìš©ì¤€ [<img src="images/github-mark.png" width="20" style="vertical-align:middle;">](https://github.com/elwhyjay)   | <img src='images/profile-5.jpeg' width="80"></img> |       PM, ë¦¬íŒ©í† ë§ ë° ê¸°íƒ€ êµ¬í˜„, ì•„í‚¤í…ì³ ì„¤ê³„ ë° ì„œë¹™        |
|  ì •ì›ì‹ [<img src="images/github-mark.png" width="20" style="vertical-align:middle;">](https://github.com/wonsjeong)   | <img src='images/profile-6.jpeg' width="80"></img> |    DocLayout ëª¨ë“ˆ êµ¬í˜„, Embedding Model, Fine Tuning, ë°œí‘œ    |

</div>
<br>

# í”„ë¡œì íŠ¸ ìˆ˜í–‰ ë°©ë²•

## 1. PDF OCR

ğŸ“‘ **[PDF OCR ìƒì„¸ ì„¤ëª… ë³´ê¸°](PDF_OCR/README.MD)**

![pdf-ocr_flowchart](images/pdf-ocr_flowchart.png)
### 1.1 ì‹¤í–‰
```bash
python pdf_parser.py -i "./pdf/input_pdf_folder"
python data_postprocessor.py
```

## 2. RAG

ğŸ“‘ **[RAG ìƒì„¸ ì„¤ëª… ë³´ê¸°](app/RAG/README.md)**

### 2.1 ì‹¤í–‰

```bash
cd app/RAG

# retrieval í‰ê°€
python main.py mode=retrieve

# generator í‰ê°€
python main.py mode=generate

# vectordb ìƒì„± ë° ì—…ë°ì´íŠ¸
python main.py mode=update_vectordb
```

### 2.2 í‰ê°€ ë°ì´í„° êµ¬ì¶•

- ëª©ì 
  - Retrieverì˜ Top-K Accuracy í‰ê°€ ë° Retriever, Generatorì˜ G-Eval í‰ê°€ ìˆ˜í–‰
- ë°©ë²•
  - **ì§ˆë¬¸ ìƒì„±**: GPTë¥¼ í™œìš©í•˜ì—¬ PDFì—ì„œ ê° ì¢…ëª©ì˜ ì¦ê¶Œì‚¬ë§ˆë‹¤ text ê¸°ë°˜ ì§ˆë¬¸ 10ê°œì”© ìƒì„±
  - **Query ì •ì œ**: ê° ì¢…ëª©ë³„ë¡œ 100ê°œì˜ Queryë¥¼ ìƒì„±í•œ í›„, ì¤‘ë³µì„ ì œê±°í•˜ì—¬ ìµœì¢… Query ì„ ì •
  - **ë‹µë³€ ì¶”ì¶œ**: ì •ì œëœ Queryë¥¼ ê° ì¦ê¶Œì‚¬ ë¦¬í¬íŠ¸ì— ì ìš©í•˜ì—¬ answers ë„ì¶œ
  - **Ground Truth ê°•í™”**: ì¢…ëª©ë³„ë¡œ ë‹¤ì–‘í•œ ì¦ê¶Œì‚¬(5~6ê°œ)ë¥¼ ì„ ì •í•˜ì—¬ Ground Truthì˜ í’ˆì§ˆ í–¥ìƒ
  - **í‘œ&ê·¸ë¦¼ ì§ˆë¬¸ ì¶”ê°€**: í‘œì™€ ê·¸ë¦¼ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ì§ˆë¬¸ì„ 10ê°œ ì¶”ê°€ ìƒì„±
- í™œìš©
  - Retrieval Top-K Accuracyì—ëŠ” ì „ì²´ 1,843ê°œ í™œìš©
  - G-Eval í‰ê°€ëŠ” 1,843ê°œ ì¤‘ 75ê°œ ìƒ˜í”Œ ì‚¬ìš©

### 2.3 Embedding Model í‰ê°€

|  | Top_1 | Top_5 | Top_10 | Top_20 | Top_30 | Top_50 |
| --- | --- | --- | --- | --- | --- | --- |
| TF-IDF | 9.80 | 22.55 | 37.52 | 59.89 | 72.64 | 90.94 |
| BM25 | 12.20 | 28.84 | 42.33 | 63.59 | 79.85 | 96.12 |
| klue/roberta-large | 2.40 | 11.46 | 20.89 | 38.26 | 59.15 | 86.88 |
| klue/bert base | 5.73 | 17.38 | 30.50 | 49.35 | 66.73 | 87.62 |
| multilingual-e5-large-instruct | 11.09 | 29.94 | 44.92 | 66.17 | 80.41 | 94.82 |
| nlpai-lab/KoE5 | 15.16 | 38.26 | 53.42 | 71.72 | 81.52 | 93.53 |
| BAAI/bge-m3 | 15.34 | 41.22 | 56.38 | 73.94 | 84.84 | 96.30 |
| nlpai-lab/KURE-v1 | 16.64 | 42.41 | 58.41 | 76.53 | 85.03 | 95.38 |

nlpai-labì˜ KoE5ì™€ KURE-v1ì´ ìš°ìˆ˜í•œ ì„±ëŠ¥ì„ ë³´ì˜€ë‹¤. ì‹¤ì œ ë¬¸ì„œë¥¼ ê²€í† í•œ ê²°ê³¼ íŠ¹ì • Queryì— ëŒ€í•œ ê²€ìƒ‰ ì„±ëŠ¥ì´ ë” ë›°ì–´ë‚œ KoE5ë¥¼ ìµœì¢… ëª¨ë¸ë¡œ ì„ íƒí•˜ì˜€ë‹¤.
### 2.4 Embedding Model Fine-Tuning

- Fine-tuning ë°ì´í„°: [virattt/financial-qa-10K](https://huggingface.co/datasets/virattt/financial-qa-10K)ë¥¼ ë²ˆì—­í•œ ë°ì´í„°
- Query Encoderì™€ Passage Encoderë¥¼ ë‚˜ëˆ„ì–´ Hard Negative ì—†ì´ In-Batch Negatives ë°©ì‹ìœ¼ë¡œ Multiple Negatives Ranking Lossì„ ì‚¬ìš©í•˜ì—¬ í•™ìŠµ
- ê²°ê³¼(Top-K Accuracy)
    
    
    |  | KoE5 | Fine-Tuned Model |
    | --- | --- | --- |
    | Top-1 | 15.16 | 18.11 |
    | Top-5 | 38.26 | 43.07 |
    | Top-10 | 53.42 | 58.78 |
    | Top-20 | 71.72 | 75.60 |
    | Top-30 | 81.52 | 85.40 |
    | Top-50 | 93.53 | 95.93 |

### 2.5 Vector Store

- ChromaDB: Metadataë¥¼ ì €ì¥í•˜ì—¬ Filtering ê¸°ëŠ¥ì„ ì œê³µí•˜ê³ , íšŒì‚¬ë³„ ê²€ìƒ‰ì´ ê°€ëŠ¥í•´ ì •ë³´ì˜ ì •í™•ì„±ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤. ë˜í•œ, ì„œë²„ ì‹¤í–‰ ì¤‘ì—ë„ DBë¥¼ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆì–´ ìœ ì—°ì„±ì´ ë›°ì–´ë‚˜ ì´ëŸ¬í•œ ì  ë•Œë¬¸ì— ì„ íƒí–ˆë‹¤.

### 2.6 Reranker

- Cross Encoderë¡œ ë¬¸ì„œì™€ ì§ˆì˜ì˜ ìœ ì‚¬ë„ë¥¼ ì¸¡ì •í•˜ì—¬ ë¬¸ì„œë¥¼ ì¬ì •ë ¬
- ì‹¤í—˜

|| Top_1 | Top_5 | Top_10 | Top_20 | Top_30 | Top_50 |
| --- | --- | --- | --- | --- | --- | --- |
| nlpai-lab/KoE5 | 15.16 | 38.26 | 53.42 | 71.72 | 81.52 | 93.53 |
| nlpai-lab/KoE5 + BAAI/bge-reranker-v2-m3 | 19.78 | 43.25 | 61.55 | 77.08 | 85.58 | 95.75 |
| nlpai-lab/KoE5 + Dongjin-kr/ko-reranker | 20.15 | 45.47 | 61.37 | 78.00 | 87.25 | 96.49 |
- Rerankerë¥¼ ì‚¬ìš©í•œ í›„ Accuracyê°€ ì „ë°˜ì ìœ¼ë¡œ ì•½ 5% ì´ìƒ ì¦ê°€í•˜ì˜€ê³  ê·¸ ì¤‘ ì„±ëŠ¥ì´ ë” ì¢‹ì€ Dongjin-kr/ko-rerankerë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.

### 2.7 Generator

- í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§
- ì¿¼ë¦¬ ë¦¬ë¼ì´íŒ…
    - 2ê°œ ì´ìƒì˜ íšŒì‚¬ ì •ë³´ê°€ í•„ìš”í•˜ê±°ë‚˜ ì§ˆë¬¸ì´ ë¶€ì ì ˆí•œ ê²½ìš° ë¦¬ë¼ì´íŒ…ì„ í†µí•´ ê²€ìƒ‰ ì„±ëŠ¥ í–¥ìƒ

### 2.8 Evaluation

- G-Eval(Retrieval, Generator)
    - Top-K Accuracy, BLEU ë“±ì€ ìƒí™©ì— ë”°ë¼ ì œëŒ€ë¡œ ëœ í‰ê°€ê°€ ë¶ˆê°€ëŠ¥í•˜ê³ , ì‚¬ëŒì´ ì¼ì¼ì´ ë°ì´í„°ë¥¼ ì±„ì í•  ìˆ˜ ì—†ì–´ì„œ LLM-as-a-Judge ë°©ì‹ìœ¼ë¡œ G-Evalì„ ì„ íƒí•˜ì˜€ë‹¤.
    - ë¹ ë¥¸ êµ¬í˜„ê³¼ ì›í™œí•œ í‰ê°€ë¥¼ ìœ„í•´ DeepEval Open Sourceë¥¼ í™œìš©
    - Retrieval G-Eval ê²°ê³¼
 
| Retrieval (top5)               | ìœ ì‚¬ì„± | í•„ìˆ˜ ì •ë³´ í¬í•¨ ì—¬ë¶€ | ì§ˆë¬¸ ì¶©ì¡±ë„ | ê´€ë ¨ì„± | ê°„ê²°ì„± | total  |
|---------------------------------|--------|------------------|------------|--------|--------|--------|
| BAAI/bge-m3                     | 2.52   | 3                | 2.34       | 1.92   | 1      | 10.81  |
| nlpai-lab/KURE-v1               | 2.62   | 3                | 2.36       | 1.98   | 0.99   | 10.98  |
| fine-tuned/nlpai-lab/KURE-v1    | 2.68   | 2.87             | 2.41       | 1.8    | 1.3    | 11.08  |
      - Generator G-Eval ê²°ê³¼

| Generation | criterion1 | criterion2 | criterion3 | criterion4 | criterion5 | criterion6 | criterion7 | criterion8 | criterion9 | total |
|------------|------------|------------|------------|------------|------------|------------|------------|------------|------------|--------|
| Top-5      | 2.7        | 2.7        | 2.8        | 2.4        | 1.6        |1.7        | 1.2        | 0.4        | 0.6        | 16.2   |
| **Top-7**  | **3.1**    | **3.0**    | **3.0**    | **2.9**    | 1.6        |2.0        | 1.3        | 0.4        | 0.7        | 18.3   |
| Top-10     | 3.0        | 2.9        | 2.8        | 2.6        | **1.7**    |1.7        | 1.1        | 0.4        | 0.7        | 17.0   |


## 3. API

ğŸ“‘ **[API ìƒì„¸ ì„¤ëª… ë³´ê¸°](app/README.md)**

REST API ê°œë°œ (íŒŒì´ì¬ API, Query API)

### 3.1 ì‹¤í–‰

```bash
cd app
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

### 3.2 Endpoint

- query
- documents
- chatting

## 4. FE

### 4.1 ì‹¤í–‰

```bash
cd FE
npm install
npm run dev
```

<!-- ì˜ìƒ ì¬ìƒ ì•ˆ ë¨ -->

<video src="images/demo.mov" autoplay muted loop></video>

### 4.2 ê¸°ëŠ¥

- AI ëª¨ë¸ ì„ íƒ(GPT-4o, GPT-4o-mini, Clova X)
- ì²¨ë¶€í•œ PDF ë¬¸ì„œë¥¼ ë²¡í„° DBí™”í•˜ì—¬ íš¨ìœ¨ì ì¸ ê²€ìƒ‰ ì§€ì›
- ì´ì „ contextë¥¼ ìœ ì§€í•œ ì‹¤ì‹œê°„ ëŒ€í™”
- ìœ„ì ¯: ì½”ìŠ¤í”¼ ì§€ìˆ˜, ì‹¤ì‹œê°„ í™˜ìœ¨, ìµœì‹  ê²½ì œ ë‰´ìŠ¤, ì¢…ëª© ê´€ë ¨ ì •ë³´, ì¢…ëª©ë³„ ìµœì‹  ë‰´ìŠ¤

<br>

# ê²°ê³¼

### ì‚¬ìš© ê¸°ìˆ 

- **OCR**: DocLayout-Yolo, Clova OCR, Upstage Parser API
- **VectorDB**: ChromaDB
- **Retriever: Langchain**
- **Generator**: Langchain, LLM-based Answering Model (gpt-4o, Clova X)
- **Evaluation**: G-Eval, Top-K Accuracy
- API server: Fastapi
- **Web Front-end**: React.js, Tailwind CSS

### íŒ€ì›Œí¬ & í˜‘ì—… ê²½í—˜

- í˜‘ì—… ë„êµ¬ : Github issueì™€ discussionìœ¼ë¡œ task í• ë‹¹ ë° í† ì˜ ğŸ¤
- Commit ê´€ë¦¬ : Github commit message templateìœ¼ë¡œ ì¼ê´€ì„± ìœ ì§€, í˜‘ì—… íš¨ìœ¨ ì¦ëŒ€ ğŸ“š

### í”„ë¡œì íŠ¸ ì§„í–‰ ë°©ì‹

- í”„ë¡œì íŠ¸ ê´€ë¦¬ : Notionì— ì™„ë£Œëœ ì¼ ê³µìœ , Zoom meetingì„ í†µí•´ ì§„í–‰ ìƒí™© í† ì˜
